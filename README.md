# Google Calendar Event Selector

Googleカレンダー上で複数の予定を選択して、日時範囲をまとめてコピーできるChrome拡張機能です。

## 機能

- **複数選択**: Ctrl/Cmd + クリックで複数の予定を簡単に選択
- **自動ソート**: 選択した予定を日時順に自動整理
- **ワンクリックコピー**: 選択した予定の日時範囲をクリップボードにコピー
- **見やすいUI**: ドラッグ可能なフローティングパネルで選択中の予定を常に確認
- **多言語対応**: 日本語・英語のGoogleカレンダーに対応
- **終日イベント対応**: 時刻なしの終日イベントも選択可能
- **エラーハンドリング**: 問題発生時に視覚的な通知を表示
- **パフォーマンス最適化**: debounceによる効率的なイベント処理
- **セキュア**: XSS対策済み（innerHTML不使用）

## スクリーンショット

<!-- TODO: スクリーンショットを追加 -->

## インストール方法

### 開発者モードでのインストール

1. このリポジトリをクローン:
   ```bash
   git clone https://github.com/rasshii/google-calendar-event-selector.git
   ```

2. Chromeで拡張機能ページを開く:
   - `chrome://extensions/` にアクセス
   - または、メニュー > その他のツール > 拡張機能

3. 「デベロッパーモード」を有効化（右上のトグル）

4. 「パッケージ化されていない拡張機能を読み込む」をクリック

5. クローンしたフォルダを選択

6. Googleカレンダー（https://calendar.google.com）を開いて使用開始

## 使い方

### 基本的な使い方

1. Googleカレンダーを開くと、右上にフローティングパネルが表示されます

2. **予定を選択**:
   - `Ctrl` (Windows/Linux) または `Cmd` (Mac) を押しながら予定をクリック
   - 選択した予定が紫色の枠で強調表示されます
   - パネルに選択した予定がリスト表示されます

3. **コピー**:
   - 「📋 コピー」ボタンをクリック
   - 選択した予定の日時がクリップボードにコピーされます

4. **クリア**:
   - 「🗑️ クリア」ボタンで選択を全てクリア

### コピー形式

選択した予定は以下の形式でコピーされます:

**日本語カレンダー:**
```
11月20日(水) 18時~19時
11月21日(木) 14時30分~15時
11月22日(金) 終日
```

**英語カレンダー:**
```
Nov 20 (Wed) 6PM-7PM
Nov 21 (Thu) 2:30PM-3PM
Nov 22 (Fri) All day
```

### パネル操作

- **ドラッグ**: ヘッダーをドラッグしてパネルを自由に移動
- **最小化**: ヘッダーの「−」ボタンで最小化/展開
- **個別削除**: 各予定の「×」ボタンで個別に選択解除

## 技術仕様

### 対応ブラウザ
- Google Chrome (Manifest V3対応)
- その他のChromiumベースのブラウザ（Edge, Brave等）

### 対応ページ
- Googleカレンダー (https://calendar.google.com/*)
- 週表示・日表示に対応
- 日本語・英語版に対応

### 使用技術
- **Manifest V3**: 最新のChrome拡張機能仕様
- **Content Script**: カレンダーページに直接機能を注入
- **Vanilla JavaScript**: フレームワーク不要の軽量実装
- **CSS3**: モダンでレスポンシブなUI
- **MutationObserver**: 動的なDOM変更の監視
- **Debounce**: パフォーマンス最適化
- **XSS対策**: innerHTML不使用、createElement利用

## ファイル構成

```
google-calendar-event-selector/
├── manifest.json       # 拡張機能の設定ファイル
├── content.js          # メイン機能スクリプト
├── styles.css          # UIスタイル
├── icon16.png          # アイコン (16x16)
├── icon48.png          # アイコン (48x48)
├── icon128.png         # アイコン (128x128)
├── icon.svg            # アイコンのソースファイル
└── README.md           # このファイル
```

## 開発

### ローカル開発

1. リポジトリをクローン
2. コードを編集
3. Chrome拡張機能ページで「更新」ボタンをクリック
4. Googleカレンダーをリロードして動作確認

### デバッグ

- Chromeデベロッパーツールでコンソールログを確認
- `console.log('Google Calendar Event Selector が初期化されました')` が表示されれば正常動作

### アイコン生成

アイコンを再生成する場合:

```bash
chmod +x create-icons.sh
./create-icons.sh
```

## 実装済みの改善

- ✅ 英語版Googleカレンダー対応（多言語対応）
- ✅ 終日イベント対応
- ✅ パネルのドラッグ移動機能
- ✅ エラーハンドリングと通知機能
- ✅ パフォーマンス最適化（debounce）
- ✅ セキュリティ強化（XSS対策）
- ✅ MutationObserverのクリーンアップ処理
- ✅ 年判定ロジックの改善

## 既知の問題

- 月表示では正確に動作しない可能性があります
- 一部の特殊なイベント形式では時刻抽出に失敗する可能性があります

## 今後の改善予定

- [ ] 月表示での動作改善
- [ ] カスタマイズ可能なコピー形式（設定画面）
- [ ] 繰り返しイベントの詳細対応
- [ ] Chrome Web Storeへの公開
- [ ] 他言語対応の拡張（フランス語、ドイツ語等）

## ライセンス

MIT License

## 作者

rasshii

## 貢献

プルリクエストやイシューの報告を歓迎します！

1. このリポジトリをフォーク
2. 機能ブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add some amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## サポート

問題や質問がある場合は、GitHubのIssuesページで報告してください。
